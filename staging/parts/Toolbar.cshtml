@inherits Custom.Hybrid.RazorTyped
@using ThisApp.Data

@* Return directly if we don't have edit permissions *@
@if (!MyUser.IsContentAdmin) {
  return;
}

@* normal toolbar & toolbar to edit registrations of this course - opens the items and filters by this contentblock *@
@{
  var appRes = As<AppResources>(App.Resources);
  // Parameters handed in from the calling Razor
  var sendMailHepler = GetService<SendMailConfigHelper>();
  var sendMailConfig = sendMailHepler.GetSendMail(appRes, As<SendMailConfig>(MyModel.Item("FormConfig")));


  var workflowId = MyModel.String("WorkflowId");

  var workflow = AsItems(App.Data["Workflow"]).Where(w => w.String("WorkflowId") == workflowId).FirstOrDefault();

  var toolbar = Kit.Toolbar.Default()
    .Settings(show: "always")
    // Show a data-button which filters the submits by this content-type and module
    .Data(workflow.String("ContentType"), tweak: b => b.Filter("ModuleId",  MyContext.Module.Id).Note(appRes.ToolbarViewData))
    // Remove edit and add a new one with custom note
    .Edit("-")
    .Edit(sendMailConfig, tweak: b => b.Note(appRes.ToolbarConfigure))
    .AppResources(tweak: b => b.Color("#15585F").Note(appRes.ToolbarAppResources));
}
<div @toolbar.For(sendMailConfig)></div>
